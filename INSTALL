                        Sanewall Installation
                        *********************

These instructions apply to packages downloaded from:
   http://download.sanewall.org/releases

If you have installed sanewall via your distribution, there may be some
differences.

Installing from the tar-file
============================
Obtain the distribution file. It will look something like:
   sanewall-x.y.z.tar.gz

To install you just need to perform the following steps:
  1. Unpack and change directory:
       tar xvfz sanewall-x.y.z.tar.gz
       cd sanewall-x.y.z

  2. Copy sanewall script to /usr/sbin:
       sudo cp sanewall /usr/sbin

  3. If you are replacing FireHOL you should just be able to create the
     sanewall configuration by copying the FireHOL config:
       sudo cp -rp /etc/firehol /etc/sanewall
       sudo mv /etc/firehol/firehol.conf /etc/sanewall/sanewall.conf

     Otherwise, create a default configuration if this is your first
     installation:
       sudo mkdir /etc/sanewall
       sudo cp etc/RESERVED_IPS /etc/sanewall
       sudo cp examples/client-all.conf /etc/sanewall/sanewall.conf

  4. Run sanewall to generate your new iptables firewall:
       sudo sanewall start

  5. Documentation is under the doc and man directories:
       sudo cp -r man/man* /usr/man
       sudo cp doc /usr/share/doc/sanewall

Note that you will also want to ensure that sanewall runs at boot-time. How
you do so depends on your distribution. Some example init scripts are provided
in the init.d directory.


Installing from the rpm-file
============================
This process has been shown to work on Fedora Core 16. Please report any
problems for this or other systems at:
  http://bugs.sanewall.org/sanewall

Obtain the distribution file. It will look something like:
  sanewall-x.y.z-orig.noarch.rpm

To install you just need to perform the following steps:
  1. If you are replacing FireHOL, copy the configuration to a sanewall
     configuration:
       sudo cp -rp /etc/firehol /etc/sanewall
       sudo mv /etc/firehol/firehol.conf /etc/sanewall/sanewall.conf

     Otherwise, the installer will create a default configuration.

  2. If you are replacing FireHOL, you will first need to remove it:
       sudo yum remove firehol

  3. Install the package:
       sudo yum install sanewall-x.y.z-orig.noarch.rpm

  4. Enable the service at boot time and start it immediately:
       sudo systemctl enable sanewall.service
       sudo systemctl start firehol.service

     You can use the "stop" and "status" commands to systemctl to control
     or see the sanewall status.

     Older systems will use the chkconfig system utility to enable/disable
     sanewall.

Sanewall is installed as /usr/sbin/sanewall with an init script also provided
as /etc/init.d/sanewall.


Installing from the deb-file
============================
This process has been shown to work on Ubuntu 12.04. Please report any
problems for this or other systems at:
  http://bugs.sanewall.org/sanewall

Obtain the distribution file. It will look something like:
  sanewall_x.y.z_all.deb

To install you just need to perform the following steps:
  1. Install the package:
       sudo dpkg -i sanewall_x.y.z_all.deb

     If there is an existing FireHOL configuration it will be removed
     and turned into a Sanewall configuration.

     The FireHOL commands will be removed if they are present and
     replaced with the sanewall equvalents.

  2. Sanewall will be set up to start at boot time. To control this
     behaviour use update-rc.d. You have to enable sanewall in
     /etc/default/sanewall to have sanewall start. To enable it set
     START_SANEWALL to anything other than NO/no. 

Sanewall is installed as /sbin/sanewall with an init script also provided
as /etc/init.d/sanewall.


Building/Installing from Source
===============================
As sanewall is a shell script there is no compilation step, however there
is an ant script (build.xml) to build the documentation and tar-file.

If you do not wish to perform these steps, you can simply copy the files
in much the same manner as described in "Installing from the tar-file".


Initial Setup
=============
When you first install the program you need to set your configuration in the
file /etc/sanewall/sanewall.conf.

Either start from one of the examples:
  client-all.conf     -  Simplest firewall for a standalone system (installed
                         by default)
  lan-gateway.conf
  server-dmz.conf
  office.conf

Alternatively, run:
  sanewall wizard

Sanewall will try to generate a configuration tailored to the machine
it is running on.
 

Other setup options
===================

Adding additional services
--------------------------
In addition to defining extra services in the sanewall.conf file, it is
possible to define new services by putting extra config files into the
/etc/sanewall/services directory.

Every file with the ending .conf gets parsed. Config files should start
with a special header:

#FHVER: 1:213

Which was originally defined within FireHOL. 1 is the API version and
will be updated if a backwards-incompatible change is introduced. 213
was the minimum version of FireHOL the service was expected to work with
and is ignored in sanewall.

The format for service definition is the same as for adding a service
to the main configuration file. See here for details:
  http://www.sanewall.org/

An example is provided in bittorrent.conf in the documentation folder.

Waiting for a network device
----------------------------
If you want to have sanewall to wait until a network device is up before
it creates the firewall rules you can set the name of the device in
/etc/defaults/sanewall as the value of:
  WAIT_FOR_IFACE

Sanewall will wait until the devices is up or until 60 seconds have elapsed.

Note that your device does not need to be up in order to create the firewall
so this option should only be used if you have a specific need to wait.
